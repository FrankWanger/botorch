<!DOCTYPE html><html lang=""><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>BoTorch · Bayesian Optimization in PyTorch</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Bayesian Optimization in PyTorch"/><meta property="og:title" content="BoTorch · Bayesian Optimization in PyTorch"/><meta property="og:type" content="website"/><meta property="og:url" content="https://botorch.org/v/0.2.1/"/><meta property="og:description" content="Bayesian Optimization in PyTorch"/><meta property="og:image" content="https://botorch.org/v/0.2.1/img/botorch.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://botorch.org/v/0.2.1/img/botorch.png"/><link rel="shortcut icon" href="/v/0.2.1/img/botorch.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-139570076-2', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/v/0.2.1/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/v/0.2.1/js/code_block_buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/v/0.2.1/js/mathjax.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/v/0.2.1/js/scrollSpy.js"></script><link rel="stylesheet" href="/v/0.2.1/css/main.css"/><script src="/v/0.2.1/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/v/0.2.1/"><img class="logo" src="/v/0.2.1/img/botorch_logo_lockup_white.png" alt="BoTorch"/><h2 class="headerTitleWithLogo">BoTorch</h2></a><a href="/v/0.2.1/versions"><h3>0.2.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/v/0.2.1/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/v/0.2.1/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/v/0.2.1/api/" target="_self">API Reference</a></li><li class=""><a href="https://github.com/pytorch/botorch" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span></span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/">Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Using BoTorch with Ax</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/custom_botorch_model_in_ax">Using a custom BoTorch model</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Full Optimization Loops</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/v/0.2.1/tutorials/closed_loop_botorch_only">q-Noisy Constrained EI</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Bite-Sized Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/fit_model_with_torch_optimizer">Fitting a model using torch.optim</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/compare_mc_analytic_acquisition">Comparing analytic and MC Expected Improvement</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/optimize_with_cmaes">Acquisition function optimization with CMA-ES</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/optimize_stochastic">Acquisition function optimization with torch.optim</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/batch_mode_cross_validation">Using batch evaluation for fast cross-validation</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/custom_acquisition">Writing a custom acquisition function</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/one_shot_kg">The one-shot Knowledge Gradient acquisition function</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/max_value_entropy">The max-value entropy search acquisition function</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Usage</h3><ul class=""><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/meta_learning_with_rgpe">Meta-learning with RGPE</a></li><li class="navListItem"><a class="navItem" href="/v/0.2.1/tutorials/vae_mnist">High-dimensional optimization with VAEs</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="tutorialBody">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<div class="notebook">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Closed-loop-batch,-constrained-BO-in-BoTorch-with-qEI-and-qNEI">Closed-loop batch, constrained BO in BoTorch with qEI and qNEI<a class="anchor-link" href="#Closed-loop-batch,-constrained-BO-in-BoTorch-with-qEI-and-qNEI">¶</a></h2><p>In this tutorial, we illustrate how to implement a simple Bayesian Optimization (BO) closed loop in BoTorch.</p>
<p>In general, we recommend for a relatively simple setup (like this one) to use Ax, since this will simplify your setup (including the amount of code you need to write) considerably. See the <a href="./custom_botorch_model_in_ax">Using BoTorch with Ax</a> tutorial.</p>
<p>However, you may want to do things that are not easily supported in Ax at this time (like running high-dimensional BO using a VAE+GP model that you jointly train on high-dimensional input data). If you find yourself in such a situation, you will need to write your own optimization loop, as we do in this tutorial.</p>
<p>We use the batch Expected Improvement (qEI) and batch Noisy Expected Improvement (qNEI) acquisition functions to optimize a constrained version of the synthetic Hartmann6 test function. The standard problem is</p>
$$f(x) = -\sum_{i=1}^4 \alpha_i \exp \left( -\sum_{j=1}^6 A_{ij} (x_j - P_{ij})^2  \right)$$<p>over $x \in [0,1]^6$ (parameter values can be found in <code>botorch/test_functions/hartmann6.py</code>).</p>
<p>In real BO applications, the design $x$ can influence multiple metrics in unknown ways, and the decision-maker often wants to optimize one metric without sacrificing another. To illustrate this, we add a synthetic constraint fo the form $\|x\|_1 - 3 \le 0$. Both the objective and the constraint are observed with noise.</p>
<p>Since botorch assumes a maximization problem, we will attempt to maximize $-f(x)$ to achieve $\max_{x} -f(x) = 3.32237$.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Problem-setup">Problem setup<a class="anchor-link" href="#Problem-setup">¶</a></h3><p>First, we define the constraint used in the example in <code>outcome_constraint</code>. The second function <code>weighted_obj</code> is a "feasibility-weighted objective," which returns zero when not feasible.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch.test_functions.hartmann6</span> <span class="kn">import</span> <span class="n">neg_hartmann6</span>

<span class="k">def</span> <span class="nf">outcome_constraint</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">"""L1 constraint; feasible if less than or equal to zero."""</span>
    <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">weighted_obj</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">"""Feasibility weighted objective; zero if not feasible."""</span>
    <span class="k">return</span> <span class="n">neg_hartmann6</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome_constraint</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">type_as</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Model-initialization">Model initialization<a class="anchor-link" href="#Model-initialization">¶</a></h4><p>We use a <code>MultiOutputGP</code> to model the objective (output 0) and the constraint (output 1). We assume known homoskedastic observation noise on both the objective and constraint with standard error $\sigma = 0.5$.</p>
<p>Each component is a <code>FixedNoiseGP</code>. The models are initialized with 10 points drawn randomly from $[0,1]^6$.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch.models</span> <span class="kn">import</span> <span class="n">FixedNoiseGP</span><span class="p">,</span> <span class="n">ModelListGP</span>
<span class="kn">from</span> <span class="nn">gpytorch.mlls.sum_marginal_log_likelihood</span> <span class="kn">import</span> <span class="n">SumMarginalLogLikelihood</span>

<span class="n">NOISE_SE</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">train_yvar</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">NOISE_SE</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">generate_initial_data</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># generate training data</span>
    <span class="n">train_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">exact_obj</span> <span class="o">=</span> <span class="n">neg_hartmann6</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># add output dimension</span>
    <span class="n">exact_con</span> <span class="o">=</span> <span class="n">outcome_constraint</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># add output dimension</span>
    <span class="n">train_obj</span> <span class="o">=</span> <span class="n">exact_obj</span> <span class="o">+</span> <span class="n">NOISE_SE</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">exact_obj</span><span class="p">)</span>
    <span class="n">train_con</span> <span class="o">=</span> <span class="n">exact_con</span> <span class="o">+</span> <span class="n">NOISE_SE</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">exact_con</span><span class="p">)</span>
    <span class="n">best_observed_value</span> <span class="o">=</span> <span class="n">weighted_obj</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">train_x</span><span class="p">,</span> <span class="n">train_obj</span><span class="p">,</span> <span class="n">train_con</span><span class="p">,</span> <span class="n">best_observed_value</span>
    
    
<span class="k">def</span> <span class="nf">initialize_model</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_obj</span><span class="p">,</span> <span class="n">train_con</span><span class="p">,</span> <span class="n">state_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># define models for objective and constraint</span>
    <span class="n">model_obj</span> <span class="o">=</span> <span class="n">FixedNoiseGP</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_obj</span><span class="p">,</span> <span class="n">train_yvar</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">train_obj</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="n">model_con</span> <span class="o">=</span> <span class="n">FixedNoiseGP</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_con</span><span class="p">,</span> <span class="n">train_yvar</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">train_con</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">train_x</span><span class="p">)</span>
    <span class="c1"># combine into a multi-output GP model</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ModelListGP</span><span class="p">(</span><span class="n">model_obj</span><span class="p">,</span> <span class="n">model_con</span><span class="p">)</span>
    <span class="n">mll</span> <span class="o">=</span> <span class="n">SumMarginalLogLikelihood</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="c1"># load state dict if it is passed</span>
    <span class="k">if</span> <span class="n">state_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mll</span><span class="p">,</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Define-a-construct-to-extract-the-objective-and-constraint-from-the-GP">Define a construct to extract the objective and constraint from the GP<a class="anchor-link" href="#Define-a-construct-to-extract-the-objective-and-constraint-from-the-GP">¶</a></h4><p>The methods below take the outputs of the GP and return the objective and the constraint. In general, these can be any <code>Callable</code>, but here we simply need to index the correct output.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch.acquisition.objective</span> <span class="kn">import</span> <span class="n">ConstrainedMCObjective</span>

<span class="k">def</span> <span class="nf">obj_callable</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Z</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">constraint_callable</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Z</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># define a feasibility-weighted objective for optimization</span>
<span class="n">constrained_obj</span> <span class="o">=</span> <span class="n">ConstrainedMCObjective</span><span class="p">(</span>
    <span class="n">objective</span><span class="o">=</span><span class="n">obj_callable</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">constraint_callable</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Define-a-helper-function-that-performs-the-essential-BO-step">Define a helper function that performs the essential BO step<a class="anchor-link" href="#Define-a-helper-function-that-performs-the-essential-BO-step">¶</a></h4><p>The helper function below takes an acquisition function as an argument, optimizes it, and returns the batch $\{x_1, x_2, \ldots x_q\}$ along with the observed function values. For this example, we'll use a small batch of $q=3$. The function <code>optimize_acqf</code> optimizes the $q$ points jointly. A simple initialization heuristic is used to select the 10 restart initial locations from a set of 50 random points.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch.optim</span> <span class="kn">import</span> <span class="n">optimize_acqf</span>

<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">optimize_acqf_and_get_observation</span><span class="p">(</span><span class="n">acq_func</span><span class="p">):</span>
    <span class="sd">"""Optimizes the acquisition function, and returns a new candidate and a noisy observation."""</span>
    <span class="c1"># optimize</span>
    <span class="n">candidates</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">optimize_acqf</span><span class="p">(</span>
        <span class="n">acq_function</span><span class="o">=</span><span class="n">acq_func</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
        <span class="n">q</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
        <span class="n">num_restarts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">raw_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># used for intialization heuristic</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">"batch_limit"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">"max_iter"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># observe new values </span>
    <span class="n">new_x</span> <span class="o">=</span> <span class="n">candidates</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
    <span class="n">exact_obj</span> <span class="o">=</span> <span class="n">neg_hartmann6</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># add output dimension</span>
    <span class="n">exact_con</span> <span class="o">=</span> <span class="n">outcome_constraint</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># add output dimension</span>
    <span class="n">new_obj</span> <span class="o">=</span> <span class="n">exact_obj</span> <span class="o">+</span> <span class="n">NOISE_SE</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">exact_obj</span><span class="p">)</span>
    <span class="n">new_con</span> <span class="o">=</span> <span class="n">exact_con</span> <span class="o">+</span> <span class="n">NOISE_SE</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">exact_con</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_x</span><span class="p">,</span> <span class="n">new_obj</span><span class="p">,</span> <span class="n">new_con</span>


<span class="k">def</span> <span class="nf">update_random_observations</span><span class="p">(</span><span class="n">best_random</span><span class="p">):</span>
    <span class="sd">"""Simulates a random policy by taking a the current list of best values observed randomly,</span>
<span class="sd">    drawing a new random point, observing its value, and updating the list.</span>
<span class="sd">    """</span>
    <span class="n">rand_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">next_random_best</span> <span class="o">=</span> <span class="n">weighted_obj</span><span class="p">(</span><span class="n">rand_x</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">best_random</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">best_random</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">next_random_best</span><span class="p">))</span>       
    <span class="k">return</span> <span class="n">best_random</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Perform-Bayesian-Optimization-loop-with-qNEI">Perform Bayesian Optimization loop with qNEI<a class="anchor-link" href="#Perform-Bayesian-Optimization-loop-with-qNEI">¶</a></h3><p>The Bayesian optimization "loop" for a batch size of $q$ simply iterates the following steps:</p>
<ol>
<li>given a surrogate model, choose a batch of points $\{x_1, x_2, \ldots x_q\}$</li>
<li>observe $f(x)$ for each $x$ in the batch </li>
<li>update the surrogate model. </li>
</ol>
<p>Just for illustration purposes, we run three trials each of which do <code>N_BATCH=20</code> rounds of optimization. The acquisition function is approximated using <code>MC_SAMPLES=500</code> samples.</p>
<p><em>Note</em>: Running this may take a little while.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">botorch</span> <span class="kn">import</span> <span class="n">fit_gpytorch_model</span>
<span class="kn">from</span> <span class="nn">botorch.acquisition.monte_carlo</span> <span class="kn">import</span> <span class="n">qExpectedImprovement</span><span class="p">,</span> <span class="n">qNoisyExpectedImprovement</span>
<span class="kn">from</span> <span class="nn">botorch.sampling.samplers</span> <span class="kn">import</span> <span class="n">SobolQMCNormalSampler</span>
<span class="kn">from</span> <span class="nn">botorch.exceptions</span> <span class="kn">import</span> <span class="n">BadInitialCandidatesWarning</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">BadInitialCandidatesWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>

<span class="n">N_TRIALS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">N_BATCH</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">MC_SAMPLES</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">best_observed_all_ei</span><span class="p">,</span> <span class="n">best_observed_all_nei</span><span class="p">,</span> <span class="n">best_random_all</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="c1"># average over multiple trials</span>
<span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_TRIALS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Trial </span><span class="si">{trial:&gt;2}</span><span class="s2"> of </span><span class="si">{N_TRIALS}</span><span class="s2"> "</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
    <span class="n">best_observed_ei</span><span class="p">,</span> <span class="n">best_observed_nei</span><span class="p">,</span> <span class="n">best_random</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    
    <span class="c1"># call helper functions to generate initial training data and initialize model</span>
    <span class="n">train_x_ei</span><span class="p">,</span> <span class="n">train_obj_ei</span><span class="p">,</span> <span class="n">train_con_ei</span><span class="p">,</span> <span class="n">best_observed_value_ei</span> <span class="o">=</span> <span class="n">generate_initial_data</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">mll_ei</span><span class="p">,</span> <span class="n">model_ei</span> <span class="o">=</span> <span class="n">initialize_model</span><span class="p">(</span><span class="n">train_x_ei</span><span class="p">,</span> <span class="n">train_obj_ei</span><span class="p">,</span> <span class="n">train_con_ei</span><span class="p">)</span>
    
    <span class="n">train_x_nei</span><span class="p">,</span> <span class="n">train_obj_nei</span><span class="p">,</span> <span class="n">train_con_nei</span> <span class="o">=</span> <span class="n">train_x_ei</span><span class="p">,</span> <span class="n">train_obj_ei</span><span class="p">,</span> <span class="n">train_con_ei</span>
    <span class="n">best_observed_value_nei</span> <span class="o">=</span> <span class="n">best_observed_value_ei</span>
    <span class="n">mll_nei</span><span class="p">,</span> <span class="n">model_nei</span> <span class="o">=</span> <span class="n">initialize_model</span><span class="p">(</span><span class="n">train_x_nei</span><span class="p">,</span> <span class="n">train_obj_nei</span><span class="p">,</span> <span class="n">train_con_nei</span><span class="p">)</span>
    
    <span class="n">best_observed_ei</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_observed_value_ei</span><span class="p">)</span>
    <span class="n">best_observed_nei</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_observed_value_nei</span><span class="p">)</span>
    <span class="n">best_random</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_observed_value_ei</span><span class="p">)</span>
    
    <span class="c1"># run N_BATCH rounds of BayesOpt after the initial random batch</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_BATCH</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>    
        
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="c1"># fit the models</span>
        <span class="n">fit_gpytorch_model</span><span class="p">(</span><span class="n">mll_ei</span><span class="p">)</span>
        <span class="n">fit_gpytorch_model</span><span class="p">(</span><span class="n">mll_nei</span><span class="p">)</span>
        
        <span class="c1"># define the qEI and qNEI acquisition modules using a QMC sampler</span>
        <span class="n">qmc_sampler</span> <span class="o">=</span> <span class="n">SobolQMCNormalSampler</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="n">MC_SAMPLES</span><span class="p">)</span>
        
        <span class="c1"># for best_f, we use the best observed noisy values as an approximation</span>
        <span class="n">qEI</span> <span class="o">=</span> <span class="n">qExpectedImprovement</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model_ei</span><span class="p">,</span> 
            <span class="n">best_f</span><span class="o">=</span><span class="p">(</span><span class="n">train_obj_ei</span> <span class="o">*</span> <span class="p">(</span><span class="n">train_con_ei</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">train_obj_ei</span><span class="p">))</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">qmc_sampler</span><span class="p">,</span> 
            <span class="n">objective</span><span class="o">=</span><span class="n">constrained_obj</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="n">qNEI</span> <span class="o">=</span> <span class="n">qNoisyExpectedImprovement</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model_nei</span><span class="p">,</span> 
            <span class="n">X_baseline</span><span class="o">=</span><span class="n">train_x_nei</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">qmc_sampler</span><span class="p">,</span> 
            <span class="n">objective</span><span class="o">=</span><span class="n">constrained_obj</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="c1"># optimize and get new observation</span>
        <span class="n">new_x_ei</span><span class="p">,</span> <span class="n">new_obj_ei</span><span class="p">,</span> <span class="n">new_con_ei</span> <span class="o">=</span> <span class="n">optimize_acqf_and_get_observation</span><span class="p">(</span><span class="n">qEI</span><span class="p">)</span>
        <span class="n">new_x_nei</span><span class="p">,</span> <span class="n">new_obj_nei</span><span class="p">,</span> <span class="n">new_con_nei</span> <span class="o">=</span> <span class="n">optimize_acqf_and_get_observation</span><span class="p">(</span><span class="n">qNEI</span><span class="p">)</span>
                
        <span class="c1"># update training points</span>
        <span class="n">train_x_ei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_x_ei</span><span class="p">,</span> <span class="n">new_x_ei</span><span class="p">])</span>
        <span class="n">train_obj_ei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_obj_ei</span><span class="p">,</span> <span class="n">new_obj_ei</span><span class="p">])</span>
        <span class="n">train_con_ei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_con_ei</span><span class="p">,</span> <span class="n">new_con_ei</span><span class="p">])</span>

        <span class="n">train_x_nei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_x_nei</span><span class="p">,</span> <span class="n">new_x_nei</span><span class="p">])</span>
        <span class="n">train_obj_nei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_obj_nei</span><span class="p">,</span> <span class="n">new_obj_nei</span><span class="p">])</span>
        <span class="n">train_con_nei</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">train_con_nei</span><span class="p">,</span> <span class="n">new_con_nei</span><span class="p">])</span>

        <span class="c1"># update progress</span>
        <span class="n">best_random</span> <span class="o">=</span> <span class="n">update_random_observations</span><span class="p">(</span><span class="n">best_random</span><span class="p">)</span>
        <span class="n">best_value_ei</span> <span class="o">=</span> <span class="n">weighted_obj</span><span class="p">(</span><span class="n">train_x_ei</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">best_value_nei</span> <span class="o">=</span> <span class="n">weighted_obj</span><span class="p">(</span><span class="n">train_x_nei</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">best_observed_ei</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_value_ei</span><span class="p">)</span>
        <span class="n">best_observed_nei</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_value_nei</span><span class="p">)</span>

        <span class="c1"># reinitialize the models so they are ready for fitting on next iteration</span>
        <span class="c1"># use the current state dict to speed up fitting</span>
        <span class="n">mll_ei</span><span class="p">,</span> <span class="n">model_ei</span> <span class="o">=</span> <span class="n">initialize_model</span><span class="p">(</span>
            <span class="n">train_x_ei</span><span class="p">,</span> 
            <span class="n">train_obj_ei</span><span class="p">,</span> 
            <span class="n">train_con_ei</span><span class="p">,</span> 
            <span class="n">model_ei</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">mll_nei</span><span class="p">,</span> <span class="n">model_nei</span> <span class="o">=</span> <span class="n">initialize_model</span><span class="p">(</span>
            <span class="n">train_x_nei</span><span class="p">,</span> 
            <span class="n">train_obj_nei</span><span class="p">,</span> 
            <span class="n">train_con_nei</span><span class="p">,</span> 
            <span class="n">model_nei</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="p">)</span>
        
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Batch </span><span class="si">{iteration:&gt;2}</span><span class="s2">: best_value (random, qEI, qNEI) = "</span>
                <span class="sa">f</span><span class="s2">"({max(best_random):&gt;4.2f}, </span><span class="si">{best_value_ei:&gt;4.2f}</span><span class="s2">, </span><span class="si">{best_value_nei:&gt;4.2f}</span><span class="s2">), "</span>
                <span class="sa">f</span><span class="s2">"time = {t1-t0:&gt;4.2f}."</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"."</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
   
    <span class="n">best_observed_all_ei</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_observed_ei</span><span class="p">)</span>
    <span class="n">best_observed_all_nei</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_observed_nei</span><span class="p">)</span>
    <span class="n">best_random_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_random</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Plot-the-results">Plot the results<a class="anchor-link" href="#Plot-the-results">¶</a></h4><p>The plot below shows the best objective value observed at each step of the optimization for each of the algorithms. The confidence intervals represent the variance at that step in the optimization across the trial runs.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">botorch.test_functions.hartmann6</span> <span class="kn">import</span> <span class="n">GLOBAL_MAXIMUM</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="k">def</span> <span class="nf">ci</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N_TRIALS</span><span class="p">)</span>

<span class="n">iters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_BATCH</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">BATCH_SIZE</span>
<span class="n">y_ei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">best_observed_all_ei</span><span class="p">)</span>
<span class="n">y_nei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">best_observed_all_nei</span><span class="p">)</span>
<span class="n">y_rnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">best_random_all</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">iters</span><span class="p">,</span> <span class="n">y_rnd</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ci</span><span class="p">(</span><span class="n">y_rnd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">"random"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">iters</span><span class="p">,</span> <span class="n">y_ei</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ci</span><span class="p">(</span><span class="n">y_ei</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">"qEI"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">iters</span><span class="p">,</span> <span class="n">y_nei</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ci</span><span class="p">(</span><span class="n">y_nei</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">"qNEI"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_BATCH</span> <span class="o">*</span> <span class="n">BATCH_SIZE</span><span class="p">],</span> <span class="p">[</span><span class="n">GLOBAL_MAXIMUM</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"true best bjective"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">'number of observations (beyond initial points)'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'best objective value'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">"lower right"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x7fd2eabada58&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
CYDvvvuO/v37c/rpp3P55ZeTk5NDeno6Z599NomJifTt25fFixczZswYli1bxo033nhI3G+/+oLL
hp1Hz549Wbx4McnJyfTq1avE+ABjxoyhb9++9OvXj99++61I/A/ff5vxD93HmDFjmDRp0oF2unTp
QkpKCi+99BKnnnoq/fv358knn6xwX6uAi4hUUx6PJ+ivI5rX54jm9YPatzRjx47ltNNOY/SddwOQ
k5PDd999R1RUVLH7jx49mldffZVZs2Zx1lln8eKLLx6yz+rVq5k+fTrvTPucZ8b/B8dxuOWWW5g+
fTrffvstLVq0YOrUqcyaNYu2bduSlJTEO++8w/bt2xk7dixHHXUUL730UrH9M/nDT/nPf/7Df/7z
nyLPFRd/5syZbNiwgQULFvDII48wZcqUYuMPHTqUGTNmALB06VI6duxIeno6U6dOZd68ecydO5cP
P/yQDRs2BPkvWTxdxCYiIiFz8sknl/r8Tz/9xDXXXANAdnY2J5100iH79OvXj5iYGBo1bkK9+vXZ
sWMHa9asYejQoQDs27ePpk2bctlll3Hfffdx/fXXM3ToUIYMGUJycnKJbffpN+BAjnffffeB7du3
by82/ubNmzn11FMBGDBgAAMGDCg2fr9+/bjqqqvIyclh+vTpXHTRRfz000+sWbOGgQMHArB3716S
k5Np3759UP1YnLAUcGNMd2A68LS19oWDnjsDeATwAZ9bax8OR04iItWd4zhB7/vHzgwAOrt43zZA
bGwsBEa7heXm5gJQp04dZs+eXerI/uDnoqOjadOmDUlJSYfs++uvvzJ79mxefvllfvjhB0aOHFly
coXiFm4jNja22PhPPvlkULd5eb1eBg4cyJw5c/jss8+YMWMG8+bN49xzzy3zOfZS23EtUgmMMXWB
54FZJezyHDAMOBU4yxjTNdQ51VTrYzqzPqazqzHHNXmccU0edzWmiEQur9dLXl7eIdvj4+PZunUr
BA4r7927F4CePXvy5ZdfAvD+++8za9ahpWLBggX4fD5279pJ5v79NG7cGALnzwGef/55li5dysyZ
M5k5cyZnnXUWzz//PAsXLiwxH4BFPy4A4IcffuCYY445sL1Ro0bFxj/ppJOYPXs2AL/88gs33XRT
ifGHDh3KpEmTqF+/Ps2aNePEE09k9uzZ7N+/H8dxuPXWW8nMzCxj7xYVjhF4NnAO8H8HP2GM6QSk
WGs3Bn7+HBgErAhDXiIi4rJjjjmGxYsX8+9/3U39+vEHtvfs2ZO6detyyimncOqpp5KQkADAs88+
y7XXXst///tf4uLiePfddw+JefTRRzN8+HBW/L6a2++5H4/HwxtvvMEVV1xBbGwsrVu35tprryU+
Pp5LL72U8ePH4/V6eeihh2jVqhU5OTkMHz6cqVOnFonrOA7XXDqclO1bmTx5cpHniotfq1Ytpk+f
Tv/+/QF46aWXisQ/acCgA68fNGgQl156KQ8/nH9QuX379owZM4YBAwYQFRXFhRdeSFxcXIX6OuQF
3FqbB+QZY4p7uiVQeNLYHYC7Q0QREQmbZs2asWHDhkMOyXu9Xr7++usD+z3+eP6Ru2OOOYbvvvuu
xHijRo1i1KhRUOgwP4HzzD/++GORfRMSEpg3b94hMQpG0oVNnDjxkBxXr15NdHR0ifEJHEYvKf4f
OzPw5fkAiImJYdeuXUX2u/HGG4u9Gr68KvsitoNPeniAUk/aFHfOozwKzg25FS8UMd2OV3CYp6R4
GRkZZW4rLS2z1JhlVZXildQfVSnHcMXz+XyuflYi4T2XFq8qf1aaNm1arqlUfXn553YLDm2X6bU+
3yGvq0i8EttxOWbheJmZmVx44YUMHTq03PF9eX4cnArlt337dpYvXx7UvpVdwDcHRuEF2gBbS3tB
YmKiKw2/tNqD4ziuxSuIics5uhkvet3zpcZLSkoqc1svr1oQiNnXhQyrVryS+qMq5RiueGlpaa5+
ViLhPZcWryp/Vnbu3HnIwiLB2JGVPxqtX7/sF7Ht3bv3kDYrEq8kbscsHK9+/frFjtTLGs+X5ytX
/xdo0aIF3bt3L7KtuOsCqOz7wK21yUC8MSbBGBMNnAd8HcRLRUREarSQj8CNMScCTwIJQK4x5iLg
E2CdtXYacANQMO/eFGvt6lDnJCIiEunCcRHbIqDEY03W2rmAO8eUREREaghNpSoiUsONeHUBt09Z
UtlpSBmpgIuISJXSq1evUqdAlXwq4CIiIhGosm8jExGRamTixIl88cUX/Ll+Ix06dmLbxmSysrK4
/vrrufrqqxk1ahStW7dm0aJFbNiwgXfeeYcTTjiBW265hQULFnDUUUcdWLpz06ZNXHnlleTk5OD1
ern/sefweDyMGno9nTt3ZsGCBVx//fUsXbqUH3/8kZtuuombbrqpsrsgbFTARUSqqYdmLGfFlj2H
3W/F1j34/Q63T1lC7Zjil/0s0LV1PA+c363UfTZs2MBE+wlT3p7IB++9TWZmJp07d+bqq6+GwKpj
X331Fa+88gqTJk2idu3afP/99/z0009s3ryZI444AoD777+fq666ihEjRvDBBx/w3OOPcOtd97Jk
yRI+/vhjUlJS6NatG+vWrSMrK4thw4bVqAKuQ+giIuKqk046iW7tm+HN2ccpp5zCkCFD2Lnzr1mz
C+YSb9u2Lenp6axYsYLevXvj9Xpp164dnTp1AmDhwoUHJswZOHAga1f+RocmdencuTNNmjShVatW
NG/enDZt2tCiRQvS09PLlGfnZvVcXX2tc7N6tKoXvrKqEbiISDV1uJFygRGvLiAr18dTI45zpaDF
xsYyZ84cvv32W+bMmUNMTEyR2ckK5hsnMGW04zh4vX8VvoIlOz0ez4EppQsOox/8+oNj1SQagYuI
iOt27dpFu3btiImJ4ZNPPiEvL+/Aue2DHXXUUSxatAjHcVi/fj3r1q2DwEi+YPnOOXPm0KtXr7C+
h6pOI3AREXHdGWecwfjx4znttNO48MILOe+887jhhhuK3ffYY4+lR48e9O3bly5dunDccccBMG7c
OK666ir+97//ERsbyxtvvEFubm6Y30nVpQIuIiKuKVj6E+Cnn3468Pi22247ZN/zzjuP8847D4BX
X3212HhffPHFIdsWLlwIQL169Q7cL174cU2hAi4iUsNNua5vkbW2JTLoHLiIiEgEUgEXERGJQCrg
IiIiEUjnwEUk7KZc5+4KwlU9Xihiuh3PzQlNJDw0AhcRqekmnJv/JRFFI3AREQmpUaNGsWjRIpo0
aXJg29/+9jduv/12EhIS+O2336hXT0cAykoFXEREQu7RRx89cM+3uEOH0EVExDV79uzhjDPOoF+/
ftx///107NixslOqtjQCFxGprr64G7YtO/x+25bmfw/mPHjLHjDkvyU+PXnyZI477jieeOIJ3n//
/Rq3wEg4aQQuIiKuWblyJX369AE4sBQowD333ENiYuKBrwULFlRiltWDRuAiItVVKSPlIgpG3ld8
VuEmHcfB4/HAQUt96hy4+zQCFxER1xx99NH8+OOPAMycObOy06nWVMBFRMQ1l112GT///DMDBgxg
6dKlB7YffAj9xhtvrNQ8qwMdQhcREdc0bNiQ2bNnA5CRkcG7777LxIkTS9y/pi0B6iYVcBGRms6F
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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/v/0.2.1/files/closed_loop_botorch_only.ipynb" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Jupyter Notebook</a></div><div class="tutorialButtonWrapper buttonWrapper"><a class="tutorialButton button" download="" href="/v/0.2.1/files/closed_loop_botorch_only.py" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-download" class="svg-inline--fa fa-file-download fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg>Download Tutorial Source Code</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/v/0.2.1/" class="nav-home"><img src="/v/0.2.1/img/botorch.png" alt="BoTorch" width="66" height="58"/></a><div class="footerSection"><h5>Docs</h5><a href="/v/0.2.1/docs/introduction">Introduction</a><a href="/v/0.2.1/docs/getting_started">Getting Started</a><a href="/v/0.2.1/tutorials/">Tutorials</a><a href="/v/0.2.1/api/">API Reference</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/pytorch/botorch" data-count-href="https://github.com/pytorch/botorch/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star BoTorch on GitHub">botorch</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/v/0.2.1/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright"> Copyright © 2020 Facebook Inc.</section><script>
            (function() {
              var BAD_BASE = '/botorch/';
              if (window.location.origin !== 'https://botorch.org') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://botorch.org/v/0.2.1/' + newPathname;
                
              }
            })();
          </script></footer></div></body></html>